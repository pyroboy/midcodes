const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/index.BGtAsOY8.js","../chunks/_commonjsHelpers.BosuxZz1.js"])))=>i.map(i=>d[i]);
import{_ as fe}from"../chunks/36.jKjWACjA.js";import{s as ie,b as I,a as b,t as Q,N as ue,d as i,j as V,f as w,g as N,p as K,h as x,k as S,i as d,l as m,m as W,o as $e,P as me,M as _e,e as O,z as pe,n as X}from"../chunks/scheduler.Bl--k1HL.js";import{S as de,i as ge,c as C,a as y,m as A,t as E,b as k,d as R,g as Z,e as ee}from"../chunks/index.DR8de1tj.js";import{e as te}from"../chunks/each.En5UpT5R.js";import{s as he}from"../chunks/supabaseClient.1oeZSPjs.js";import{s as ve}from"../chunks/formData.IVesd0ZS.js";import"../chunks/index.D4E8IgGl.js";import{C as ne}from"../chunks/card.Di3vQaZg.js";import{c as be}from"../chunks/utils.D33FkIxg.js";import{T as we,a as Se,b as Ee,c as Y,d as G,e as M}from"../chunks/table-row.rK6DUprU.js";import{t as B}from"../chunks/Toaster.svelte_svelte_type_style_lang.Rgr6G_b5.js";import{B as J}from"../chunks/button.BqeWxtk_.js";function se(o,e,t){const n=o.slice();return n[18]=e[t],n}function ke(o){let e=o[2]?"Pause Scanner":"Resume Scanner",t;return{c(){t=Q(e)},l(n){t=x(n,e)},m(n,s){d(n,t,s)},p(n,s){s&4&&e!==(e=n[2]?"Pause Scanner":"Resume Scanner")&&W(t,e)},d(n){n&&i(t)}}}function De(o){let e;return{c(){e=Q("Entry")},l(t){e=x(t,"Entry")},m(t,n){d(t,e,n)},d(t){t&&i(e)}}}function Ne(o){let e;return{c(){e=Q("Exit")},l(t){e=x(t,"Exit")},m(t,n){d(t,e,n)},d(t){t&&i(e)}}}function ae(o){let e,t,n="Last Scanned:",s,r,c;return{c(){e=b("div"),t=b("p"),t.textContent=n,s=I(),r=b("p"),c=Q(o[3]),this.h()},l(l){e=w(l,"DIV",{class:!0});var a=N(e);t=w(a,"P",{class:!0,"data-svelte-h":!0}),K(t)!=="svelte-i1slpa"&&(t.textContent=n),s=V(a),r=w(a,"P",{class:!0});var f=N(r);c=x(f,o[3]),f.forEach(i),a.forEach(i),this.h()},h(){S(t,"class","font-medium"),S(r,"class","text-sm font-mono break-all"),S(e,"class","mt-4 p-4 bg-gray-50 rounded-lg")},m(l,a){d(l,e,a),m(e,t),m(e,s),m(e,r),m(r,c)},p(l,a){a&8&&W(c,l[3])},d(l){l&&i(e)}}}function Pe(o){let e,t,n,s,r,c,l,a,f,u,h,p;r=new J({props:{variant:o[2]?"destructive":"default",$$slots:{default:[ke]},$$scope:{ctx:o}}}),r.$on("click",o[7]),a=new J({props:{variant:o[4]==="entry"?"default":"outline",$$slots:{default:[De]},$$scope:{ctx:o}}}),a.$on("click",o[9]),u=new J({props:{variant:o[4]==="exit"?"default":"outline",$$slots:{default:[Ne]},$$scope:{ctx:o}}}),u.$on("click",o[10]);let v=o[3]&&ae(o);return{c(){e=b("div"),t=b("div"),n=I(),s=b("div"),C(r.$$.fragment),c=I(),l=b("div"),C(a.$$.fragment),f=I(),C(u.$$.fragment),h=I(),v&&v.c(),this.h()},l($){e=w($,"DIV",{class:!0});var g=N(e);t=w(g,"DIV",{id:!0,class:!0}),N(t).forEach(i),n=V(g),s=w(g,"DIV",{class:!0});var q=N(s);y(r.$$.fragment,q),c=V(q),l=w(q,"DIV",{class:!0});var P=N(l);y(a.$$.fragment,P),f=V(P),y(u.$$.fragment,P),P.forEach(i),q.forEach(i),h=V(g),v&&v.l(g),g.forEach(i),this.h()},h(){S(t,"id","qr-reader"),S(t,"class","w-full"),S(l,"class","flex items-center gap-4"),S(s,"class","flex justify-between items-center"),S(e,"class","space-y-4")},m($,g){d($,e,g),m(e,t),o[8](t),m(e,n),m(e,s),A(r,s,null),m(s,c),m(s,l),A(a,l,null),m(l,f),A(u,l,null),m(e,h),v&&v.m(e,null),p=!0},p($,g){const q={};g&4&&(q.variant=$[2]?"destructive":"default"),g&2097156&&(q.$$scope={dirty:g,ctx:$}),r.$set(q);const P={};g&16&&(P.variant=$[4]==="entry"?"default":"outline"),g&2097152&&(P.$$scope={dirty:g,ctx:$}),a.$set(P);const T={};g&16&&(T.variant=$[4]==="exit"?"default":"outline"),g&2097152&&(T.$$scope={dirty:g,ctx:$}),u.$set(T),$[3]?v?v.p($,g):(v=ae($),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i($){p||(E(r.$$.fragment,$),E(a.$$.fragment,$),E(u.$$.fragment,$),p=!0)},o($){k(r.$$.fragment,$),k(a.$$.fragment,$),k(u.$$.fragment,$),p=!1},d($){$&&i(e),o[8](null),R(r),R(a),R(u),v&&v.d()}}}function Ie(o){let e;return{c(){e=Q("Attendee")},l(t){e=x(t,"Attendee")},m(t,n){d(t,e,n)},d(t){t&&i(e)}}}function Ve(o){let e;return{c(){e=Q("Status")},l(t){e=x(t,"Status")},m(t,n){d(t,e,n)},d(t){t&&i(e)}}}function Ce(o){let e;return{c(){e=Q("Last Scan")},l(t){e=x(t,"Last Scan")},m(t,n){d(t,e,n)},d(t){t&&i(e)}}}function ye(o){let e,t,n,s,r,c;return e=new G({props:{$$slots:{default:[Ie]},$$scope:{ctx:o}}}),n=new G({props:{$$slots:{default:[Ve]},$$scope:{ctx:o}}}),r=new G({props:{$$slots:{default:[Ce]},$$scope:{ctx:o}}}),{c(){C(e.$$.fragment),t=I(),C(n.$$.fragment),s=I(),C(r.$$.fragment)},l(l){y(e.$$.fragment,l),t=V(l),y(n.$$.fragment,l),s=V(l),y(r.$$.fragment,l)},m(l,a){A(e,l,a),d(l,t,a),A(n,l,a),d(l,s,a),A(r,l,a),c=!0},p(l,a){const f={};a&2097152&&(f.$$scope={dirty:a,ctx:l}),e.$set(f);const u={};a&2097152&&(u.$$scope={dirty:a,ctx:l}),n.$set(u);const h={};a&2097152&&(h.$$scope={dirty:a,ctx:l}),r.$set(h)},i(l){c||(E(e.$$.fragment,l),E(n.$$.fragment,l),E(r.$$.fragment,l),c=!0)},o(l){k(e.$$.fragment,l),k(n.$$.fragment,l),k(r.$$.fragment,l),c=!1},d(l){l&&(i(t),i(s)),R(e,l),R(n,l),R(r,l)}}}function Ae(o){let e,t;return e=new Y({props:{$$slots:{default:[ye]},$$scope:{ctx:o}}}),{c(){C(e.$$.fragment)},l(n){y(e.$$.fragment,n)},m(n,s){A(e,n,s),t=!0},p(n,s){const r={};s&2097152&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){k(e.$$.fragment,n),t=!1},d(n){R(e,n)}}}function le(o){let e,t;return e=new Y({props:{$$slots:{default:[qe]},$$scope:{ctx:o}}}),{c(){C(e.$$.fragment)},l(n){y(e.$$.fragment,n)},m(n,s){A(e,n,s),t=!0},p(n,s){const r={};s&2097152&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){k(e.$$.fragment,n),t=!1},d(n){R(e,n)}}}function Re(o){let e;return{c(){e=Q("No scan logs yet")},l(t){e=x(t,"No scan logs yet")},m(t,n){d(t,e,n)},d(t){t&&i(e)}}}function qe(o){let e,t,n;return e=new M({props:{colspan:3,class:"text-center py-8 text-gray-500",$$slots:{default:[Re]},$$scope:{ctx:o}}}),{c(){C(e.$$.fragment),t=I()},l(s){y(e.$$.fragment,s),t=V(s)},m(s,r){A(e,s,r),d(s,t,r),n=!0},p(s,r){const c={};r&2097152&&(c.$$scope={dirty:r,ctx:s}),e.$set(c)},i(s){n||(E(e.$$.fragment,s),n=!0)},o(s){k(e.$$.fragment,s),n=!1},d(s){s&&i(t),R(e,s)}}}function Le(o){let e,t,n=je(o[18].basic_info)+"",s,r,c,l=o[18].reference_code_url+"",a;return{c(){e=b("div"),t=b("span"),s=Q(n),r=I(),c=b("span"),a=Q(l),this.h()},l(f){e=w(f,"DIV",{class:!0});var u=N(e);t=w(u,"SPAN",{class:!0});var h=N(t);s=x(h,n),h.forEach(i),r=V(u),c=w(u,"SPAN",{class:!0});var p=N(c);a=x(p,l),p.forEach(i),u.forEach(i),this.h()},h(){S(t,"class","font-medium"),S(c,"class","text-xs text-gray-500"),S(e,"class","flex flex-col")},m(f,u){d(f,e,u),m(e,t),m(t,s),m(e,r),m(e,c),m(c,a)},p:X,d(f){f&&i(e)}}}function Qe(o){let e,t=o[18].attendance_status+"",n;return{c(){e=b("span"),n=Q(t),this.h()},l(s){e=w(s,"SPAN",{class:!0});var r=N(e);n=x(r,t),r.forEach(i),this.h()},h(){S(e,"class",be("px-2 py-1 rounded-full text-xs font-medium",o[18].attendance_status==="present"?"bg-green-100 text-green-700":o[18].attendance_status==="exited"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"))},m(s,r){d(s,e,r),m(e,n)},p:X,d(s){s&&i(e)}}}function xe(o){let e,t,n=o[6](o[18].qr_scan_info[o[18].qr_scan_info.length-1].scan_time)+"",s,r,c,l=o[18].qr_scan_info[o[18].qr_scan_info.length-1].scan_type+"",a;return{c(){e=b("div"),t=b("span"),s=Q(n),r=I(),c=b("span"),a=Q(l),this.h()},l(f){e=w(f,"DIV",{class:!0});var u=N(e);t=w(u,"SPAN",{class:!0});var h=N(t);s=x(h,n),h.forEach(i),r=V(u),c=w(u,"SPAN",{class:!0});var p=N(c);a=x(p,l),p.forEach(i),u.forEach(i),this.h()},h(){S(t,"class","text-sm"),S(c,"class","text-xs text-gray-500"),S(e,"class","flex flex-col")},m(f,u){d(f,e,u),m(e,t),m(t,s),m(e,r),m(e,c),m(c,a)},p:X,d(f){f&&i(e)}}}function Te(o){var n;let e,t=((n=o[18].qr_scan_info)==null?void 0:n.length)&&xe(o);return{c(){t&&t.c(),e=O()},l(s){t&&t.l(s),e=O()},m(s,r){t&&t.m(s,r),d(s,e,r)},p(s,r){var c;(c=s[18].qr_scan_info)!=null&&c.length&&t.p(s,r)},d(s){s&&i(e),t&&t.d(s)}}}function He(o){let e,t,n,s,r,c,l;return e=new M({props:{$$slots:{default:[Le]},$$scope:{ctx:o}}}),n=new M({props:{$$slots:{default:[Qe]},$$scope:{ctx:o}}}),r=new M({props:{$$slots:{default:[Te]},$$scope:{ctx:o}}}),{c(){C(e.$$.fragment),t=I(),C(n.$$.fragment),s=I(),C(r.$$.fragment),c=I()},l(a){y(e.$$.fragment,a),t=V(a),y(n.$$.fragment,a),s=V(a),y(r.$$.fragment,a),c=V(a)},m(a,f){A(e,a,f),d(a,t,f),A(n,a,f),d(a,s,f),A(r,a,f),d(a,c,f),l=!0},p(a,f){const u={};f&2097152&&(u.$$scope={dirty:f,ctx:a}),e.$set(u);const h={};f&2097152&&(h.$$scope={dirty:f,ctx:a}),n.$set(h);const p={};f&2097152&&(p.$$scope={dirty:f,ctx:a}),r.$set(p)},i(a){l||(E(e.$$.fragment,a),E(n.$$.fragment,a),E(r.$$.fragment,a),l=!0)},o(a){k(e.$$.fragment,a),k(n.$$.fragment,a),k(r.$$.fragment,a),l=!1},d(a){a&&(i(t),i(s),i(c)),R(e,a),R(n,a),R(r,a)}}}function re(o){let e,t;return e=new Y({props:{$$slots:{default:[He]},$$scope:{ctx:o}}}),{c(){C(e.$$.fragment)},l(n){y(e.$$.fragment,n)},m(n,s){A(e,n,s),t=!0},p(n,s){const r={};s&2097152&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){k(e.$$.fragment,n),t=!1},d(n){R(e,n)}}}function ze(o){let e,t,n=te(o[5]),s=[];for(let l=0;l<n.length;l+=1)s[l]=re(se(o,n,l));const r=l=>k(s[l],1,1,()=>{s[l]=null});let c=null;return n.length||(c=le(o)),{c(){for(let l=0;l<s.length;l+=1)s[l].c();e=O(),c&&c.c()},l(l){for(let a=0;a<s.length;a+=1)s[a].l(l);e=O(),c&&c.l(l)},m(l,a){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(l,a);d(l,e,a),c&&c.m(l,a),t=!0},p(l,a){if(a&96){n=te(l[5]);let f;for(f=0;f<n.length;f+=1){const u=se(l,n,f);s[f]?(s[f].p(u,a),E(s[f],1)):(s[f]=re(u),s[f].c(),E(s[f],1),s[f].m(e.parentNode,e))}for(Z(),f=n.length;f<s.length;f+=1)r(f);ee(),!n.length&&c?c.p(l,a):n.length?c&&(Z(),k(c,1,1,()=>{c=null}),ee()):(c=le(l),c.c(),E(c,1),c.m(e.parentNode,e))}},i(l){if(!t){for(let a=0;a<n.length;a+=1)E(s[a]);t=!0}},o(l){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)k(s[a]);t=!1},d(l){l&&i(e),pe(s,l),c&&c.d(l)}}}function Fe(o){let e,t,n,s;return e=new Se({props:{$$slots:{default:[Ae]},$$scope:{ctx:o}}}),n=new Ee({props:{$$slots:{default:[ze]},$$scope:{ctx:o}}}),{c(){C(e.$$.fragment),t=I(),C(n.$$.fragment)},l(r){y(e.$$.fragment,r),t=V(r),y(n.$$.fragment,r)},m(r,c){A(e,r,c),d(r,t,c),A(n,r,c),s=!0},p(r,c){const l={};c&2097152&&(l.$$scope={dirty:c,ctx:r}),e.$set(l);const a={};c&2097152&&(a.$$scope={dirty:c,ctx:r}),n.$set(a)},i(r){s||(E(e.$$.fragment,r),E(n.$$.fragment,r),s=!0)},o(r){k(e.$$.fragment,r),k(n.$$.fragment,r),s=!1},d(r){r&&i(t),R(e,r),R(n,r)}}}function Ue(o){let e,t="Recent Scans",n,s,r,c;return r=new we({props:{$$slots:{default:[Fe]},$$scope:{ctx:o}}}),{c(){e=b("h2"),e.textContent=t,n=I(),s=b("div"),C(r.$$.fragment),this.h()},l(l){e=w(l,"H2",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-1rodwe7"&&(e.textContent=t),n=V(l),s=w(l,"DIV",{class:!0});var a=N(s);y(r.$$.fragment,a),a.forEach(i),this.h()},h(){S(e,"class","text-xl font-semibold mb-4"),S(s,"class","overflow-x-auto")},m(l,a){d(l,e,a),d(l,n,a),d(l,s,a),A(r,s,null),c=!0},p(l,a){const f={};a&2097152&&(f.$$scope={dirty:a,ctx:l}),r.$set(f)},i(l){c||(E(r.$$.fragment,l),c=!0)},o(l){k(r.$$.fragment,l),c=!1},d(l){l&&(i(e),i(n),i(s)),R(r)}}}function Be(o){let e,t,n,s,r,c="QR Scanner",l,a,f=o[0].event.event_name+"",u,h,p,v,$,g,q,P,T;return document.title=e="QR Scanner - "+o[0].event.event_name,$=new ne({props:{class:"p-6",$$slots:{default:[Pe]},$$scope:{ctx:o}}}),P=new ne({props:{class:"p-6",$$slots:{default:[Ue]},$$scope:{ctx:o}}}),{c(){t=I(),n=b("div"),s=b("div"),r=b("h1"),r.textContent=c,l=I(),a=b("p"),u=Q(f),h=I(),p=b("div"),v=b("div"),C($.$$.fragment),g=I(),q=b("div"),C(P.$$.fragment),this.h()},l(D){ue("svelte-1bf077",document.head).forEach(i),t=V(D),n=w(D,"DIV",{class:!0});var _=N(n);s=w(_,"DIV",{class:!0});var L=N(s);r=w(L,"H1",{class:!0,"data-svelte-h":!0}),K(r)!=="svelte-s8xfyi"&&(r.textContent=c),l=V(L),a=w(L,"P",{class:!0});var z=N(a);u=x(z,f),z.forEach(i),L.forEach(i),h=V(_),p=w(_,"DIV",{class:!0});var F=N(p);v=w(F,"DIV",{});var U=N(v);y($.$$.fragment,U),U.forEach(i),g=V(F),q=w(F,"DIV",{});var j=N(q);y(P.$$.fragment,j),j.forEach(i),F.forEach(i),_.forEach(i),this.h()},h(){S(r,"class","text-3xl font-bold mb-2"),S(a,"class","text-gray-600"),S(s,"class","mb-8"),S(p,"class","grid grid-cols-1 md:grid-cols-2 gap-8"),S(n,"class","container mx-auto px-4 py-8")},m(D,H){d(D,t,H),d(D,n,H),m(n,s),m(s,r),m(s,l),m(s,a),m(a,u),m(n,h),m(n,p),m(p,v),A($,v,null),m(p,g),m(p,q),A(P,q,null),T=!0},p(D,[H]){(!T||H&1)&&e!==(e="QR Scanner - "+D[0].event.event_name)&&(document.title=e),(!T||H&1)&&f!==(f=D[0].event.event_name+"")&&W(u,f);const _={};H&2097182&&(_.$$scope={dirty:H,ctx:D}),$.$set(_);const L={};H&2097152&&(L.$$scope={dirty:H,ctx:D}),P.$set(L)},i(D){T||(E($.$$.fragment,D),E(P.$$.fragment,D),T=!0)},o(D){k($.$$.fragment,D),k(P.$$.fragment,D),T=!1},d(D){D&&(i(t),i(n)),R($),R(P)}}}function je(o){return`${o.firstName} ${o.lastName}`}function Me(o){console.warn(`QR Scan error: ${o}`)}function Oe(o,e,t){let{data:n}=e;const{form:s,enhance:r,message:c}=ve(n.form,{onResult:({result:_})=>{if(_.type==="success"){const L=_.data;B.success((L==null?void 0:L.message)||"Scan recorded successfully"),t(3,u=null)}else _.type==="error"&&B.error("Failed to record scan")}});let l,a=null,f=!1,u=null,h="entry",p=!1,v=n.scanLogs.map(_=>({..._,attendance_status:_.attendance_status||"registered"}));const $=_=>new Date(_).toLocaleDateString("en-PH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});async function g(){try{const{Html5QrcodeScanner:_}=await fe(async()=>{const{Html5QrcodeScanner:L}=await import("../chunks/index.BGtAsOY8.js");return{Html5QrcodeScanner:L}},__vite__mapDeps([0,1]),import.meta.url);a=new _("qr-reader",{fps:10,qrbox:{width:250,height:250},aspectRatio:1,rememberLastUsedCamera:!0},!1),a.render(q,Me),t(2,f=!0)}catch(_){console.error("Failed to initialize scanner:",_),B.error("Failed to initialize QR scanner")}}async function q(_){var L;if(!(_===u||p)){t(3,u=_),p=!0;try{const z=_.split("/"),F=z[z.length-1],{data:U,error:j}=await he.from("attendees").select("id, basic_info").eq("reference_code_url",F).single();if(j||!U){B.error("Invalid QR code or attendee not found");return}new Audio("/sounds/success-beep.mp3").play().catch(console.error),s.update(ce=>({...ce,attendeeId:U.id,scannedUrl:_,scanType:h,scanNotes:""}));const oe=((L=U.basic_info)==null?void 0:L.name)||"Unknown Attendee";B.success(`Scanning ${oe}...`)}catch(z){console.error("Scan processing error:",z),B.error("Error processing scan")}finally{p=!1}}}function P(){f&&a?(a.pause(),t(2,f=!1)):a&&(a.resume(),t(2,f=!0))}$e(()=>{g()}),me(()=>{a&&a.clear()});function T(_){_e[_?"unshift":"push"](()=>{l=_,t(1,l)})}const D=()=>t(4,h="entry"),H=()=>t(4,h="exit");return o.$$set=_=>{"data"in _&&t(0,n=_.data)},[n,l,f,u,h,v,$,P,T,D,H]}class rt extends de{constructor(e){super(),ge(this,e,Oe,Be,ie,{data:0})}}export{rt as component};
